var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i};define(["require","exports","core/System","game/nodes/SpaceShipCollision","game/nodes/AsteroidCollision","game/nodes/BulletCollision","tools/Point"],function(n,t,i,r,u,f,e){var s=i,h=r,c=u,l=f,o=e,a=function(n){function t(t,i){n.call(this),this.gameState=null,this.creator=null,this.spaceships=null,this.asteroids=null,this.bullets=null,this.initialise(t,i)}return __extends(t,n),t.prototype.initialise=function(n,t){return this.gameState=n,this.creator=t,this},t.prototype.addToEngine=function(n){this.spaceships=n.getNodeList(h.SpaceshipCollision),this.asteroids=n.getNodeList(c.AsteroidCollision),this.bullets=n.getNodeList(l.BulletCollision)},t.prototype.update=function(){var u,i,n,f,e,r,t;if(this.spaceships.empty()&&this.gameState.lives>0){for(u=new o.Point(this.gameState.width*.5,this.gameState.height*.5),i=!0,n=this.asteroids.head;n;n=n.next)if(n.position.position.distanceTo(u)<=n.position.collisionRadius+50){i=!1;break}i&&(this.creator.createSpaceship(),this.gameState.lives--)}if(this.asteroids.empty()&&this.bullets.empty()&&!this.spaceships.empty())for(f=this.spaceships.head,this.gameState.level++,e=2+this.gameState.level,r=0;r<e;++r){do t=new o.Point(Math.random()*this.gameState.width,Math.random()*this.gameState.height);while(t.distanceTo(f.position.position)<=80);this.creator.createAsteroid(30,t.x,t.y)}},t.prototype.removeFromEngine=function(){this.spaceships=null,this.asteroids=null,this.bullets=null},t}(s.ash.core.System);t.GameManager=a})